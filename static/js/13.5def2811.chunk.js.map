{"version":3,"sources":["components/userProfile/ClaimForm.jsx","../node_modules/@material-ui/icons/Cancel.js"],"names":["AvatarIcon","history","useHistory","dispatch","useDispatch","useTrackedState","selectedProject","authData","React","useState","proof","email","errors","setErrors","values","setValues","handleChange","event","field","target","value","useEffect","_source","owners","getAnotherUserInfoElastic","updateOtherUserData","claimProject","data","status","index","_index","id","_id","title","user","firstName","q","doc","claimed","claimedAt","Date","formData","FormData","append","JSON","stringify","query","MATCH_ID_TITLE","replace","updateProject","key","queryEsById","updateSelectedProject","container","alignItems","spacing","item","xs","sm","md","style","marginTop","textAlign","margin","noValidate","autoComplete","label","required","multiline","fullWidth","rows","defaultValue","onChange","e","name","startIcon","disableElevation","size","color","variant","textTransform","borderRadius","onClick","goBack","marginLeft","currErrors","newErrors","test","length","validate","Object","keys","console","log","push","_interopRequireDefault","require","defineProperty","exports","default","_react","_default","createElement","d"],"mappings":"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","file":"static/js/13.5def2811.chunk.js","sourcesContent":["import Grid from \"@material-ui/core/Grid\";\nimport React from \"react\";\nimport Button from \"@material-ui/core/Button\";\nimport { useHistory } from \"react-router-dom\";\nimport { useTrackedState, useDispatch } from \"reactive-react-redux\";\nimport { getAnotherUserInfoElastic } from \"../backend/AxiosRequest\";\nimport { updateOtherUserData } from \"../redux/actions\";\nimport { queryEsById, updateProject } from \"../backend/AxiosRequest\";\nimport { updateSelectedProject } from \"../redux/actions\";\nimport { MATCH_ID_TITLE } from \"../backend/EsQueries\";\nimport CheckCircleIcon from \"@material-ui/icons/CheckCircle\";\nimport CancelIcon from \"@material-ui/icons/Cancel\";\nimport TextField from \"@material-ui/core/TextField\";\n\nexport default function AvatarIcon() {\n  const history = useHistory();\n  const dispatch = useDispatch();\n  const { selectedProject, authData } = useTrackedState();\n  const [errors, setErrors] = React.useState({\n    proof: \"\",\n    email: \"\",\n  });\n  const [values, setValues] = React.useState({\n    proof: \"\",\n    email: \"\",\n  });\n\n  const handleChange = (event, field) => {\n    setValues({ ...values, [field]: event.target.value });\n  };\n\n  const validate = () => {\n    let newErrors = {};\n    if (!values.email) {\n      newErrors.email = \"Required\";\n    } else if (\n      !/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,4}$/i.test(values.email)\n    ) {\n      newErrors.email = \"Invalid email address\";\n    }\n    if (!values.proof) {\n      newErrors.proof = \"Required\";\n    } else if (values.proof.length < 60) {\n      newErrors.proof =\n        \"Proof of ownership should be atleast 60 characters long\";\n    }\n    setErrors(newErrors);\n    return newErrors;\n  };\n  React.useEffect(() => {\n    if (selectedProject && selectedProject._source.owners) {\n      getAnotherUserInfoElastic(\n        authData,\n        \"id\",\n        selectedProject._source.owners,\n        dispatch,\n        updateOtherUserData\n      );\n    } else {\n      dispatch(updateOtherUserData(null));\n    }\n  }, []);\n\n  const handleSubmit = () => {\n    // console.log(values);\n    if (authData && authData.user) {\n      let currErrors = validate();\n      if (Object.keys(currErrors).length === 0) {\n        claimProject();\n\n        return;\n      }\n      console.log(\"errors\");\n    } else {\n      history.push(\"/sign-in\");\n    }\n  };\n\n  const handleCancel = () => {\n    history.goBack();\n  };\n\n  const claimProject = () => {\n    let data = {\n      status: \"projectclaimsubmit\",\n      index: selectedProject._index,\n      id: selectedProject._id,\n      title: selectedProject._source.title,\n      email: authData.user.email,\n      firstName: authData.user.firstName,\n      q: {\n        doc:{\n        claimed: authData.user.id,\n        claimedAt: new Date(),\n        proof: [values.proof, values.email, authData._source.firstName],\n        }\n      },\n    };\n    let formData = new FormData();\n\n    formData.append(\"params\", JSON.stringify(data));\n\n    let query = MATCH_ID_TITLE(\n      selectedProject._id,\n      selectedProject._source.title.replace(/-/g, \" \")\n    );\n    const updateData = () =>\n      queryEsById(query, dispatch, updateSelectedProject, history);\n    updateProject(\n      formData,\n      authData.key,\n      history,\n      selectedProject._source.title,\n      updateData\n    );\n  };\n\n\n\n\n  return (\n    <Grid container alignItems=\"center\" spacing={3}>\n      \n      <Grid item xs={12} sm={12} md={12}>\n      <h4 style={{ marginTop:'2rem', textAlign:'center'}}>Claim Project</h4>\n      <hr></hr>\n      </Grid>\n      <Grid item xs={12} sm={12} md={12}>\n      <h6 style={{ margin: \"0 auto\" }}>\n          Please tell us how we can verify your ownership (Include links, and\n          other relevent infomation). Also, include a valid email address for\n          our staff to contact you.\n        </h6>\n      </Grid>\n      <Grid item xs={12} sm={12} md={12}>\n        <form noValidate autoComplete=\"off\">\n          <TextField\n            id=\"claim\"\n            label={errors.proof?errors.proof:\"Proof of ownership\"}\n            required\n            multiline\n            fullWidth\n            rows={4}\n            defaultValue=\"\"\n            onChange={(e) => handleChange(e, \"proof\")}\n          />\n          <TextField\n            required\n            fullWidth\n            id=\"email\"\n            label={errors.email?errors.email:\"Email Address\"}\n            name=\"email\"\n            autoComplete=\"email\"\n            onChange={(e) => handleChange(e, \"email\")}\n          />\n        </form>\n      </Grid>\n      <Grid item xs={12} sm={12} md={12}>\n        <Button\n          startIcon={<CancelIcon />}\n          disableElevation\n          size=\"small\"\n          color=\"primary\"\n          variant=\"outlined\"\n          style={{ textTransform: \"none\", borderRadius: 25 }}\n          onClick={handleCancel}\n        >\n          {\" \"}\n          Cancel claim\n        </Button>\n        <Button\n          startIcon={<CheckCircleIcon />}\n          disableElevation\n          size=\"small\"\n          color=\"default\"\n          variant=\"contained\"\n          style={{\n            textTransform: \"none\",\n            borderRadius: 25,\n            marginLeft: \"1rem\",\n          }}\n          onClick={handleSubmit}\n        >\n          {\" \"}\n          Submit claim\n        </Button>\n      </Grid>\n      <Grid item xs={12} sm={12} md={12}>\n        <h1> </h1>\n      </Grid>\n    </Grid>\n  );\n}\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z\"\n}), 'Cancel');\n\nexports.default = _default;"],"sourceRoot":""}